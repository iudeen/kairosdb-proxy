listen = "0.0.0.0:8080"
timeout_secs = 5
max_outbound_concurrency = 32
# Maximum request body size in bytes. Requests exceeding this will return 413 Payload Too Large.
# Default is 5 MB (5242880 bytes) if not specified.
# max_request_body_bytes = 5242880
# Operation mode: "simple" forwards only the first metric; "multi" splits by metric and merges results.
# Defaults to "multi".
# mode = "multi"
# Routing cache size for Simple mode. When set, enables an LRU cache that maps metric names to
# backend indices, bypassing regex scans for cached metrics. This significantly improves performance
# for hot metrics. If not set or set to 0, the cache is disabled. Recommended size: 1000-10000.
# routing_cache_size = 1000

[[backends]]
pattern = "^cpu\\..*"
url = "http://kairosdb-1:8080"

[[backends]]
pattern = "^mem\\..*"
url = "http://kairosdb-2:8080"

# Optional token per backend
[[backends]]
pattern = "^special\\..*"
url = "https://kairosdb-secure:8443"
token = "REPLACE_WITH_TOKEN"
